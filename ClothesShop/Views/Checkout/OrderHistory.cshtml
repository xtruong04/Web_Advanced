@model IEnumerable<ClothesShop.Models.Order>

<div class="container mt-5" style="padding-top:120px;">
    <div class="row">
        <div class="col-md-3 mb-4">
            @await Html.PartialAsync("_AccountSidebar")
        </div>

        <div class="col-md-9">
            <div class="card shadow-sm rounded-4 p-4 border-0">
                <h3 class="fw-bold mb-4">Đơn hàng của tôi</h3>

                @if (Model != null && Model.Any())
                {
                    foreach (var order in Model)
                    {
                        <div class="card mb-4 border shadow-none rounded-3 overflow-hidden">
                            <div class="card-header bg-light d-flex justify-content-between align-items-center py-3">
                                <div>
                                    <span class="fw-bold">Mã đơn: #@order.Id</span>
                                    <span class="text-muted ms-2 small">| @order.OrderDate.ToString("dd/MM/yyyy HH:mm")</span>
                                </div>
                                <div>
                                    @* Hiển thị Order Status *@
                                    @{
                                        var statusClass = order.orderStatus switch
                                        {
                                            Order.OrderStatus.Pending => "bg-warning text-dark",
                                            Order.OrderStatus.Processing => "bg-primary",
                                            Order.OrderStatus.Shipped => "bg-info text-dark",
                                            Order.OrderStatus.Delivered => "bg-success",
                                            Order.OrderStatus.Cancelled => "bg-danger",
                                            _ => "bg-secondary"
                                        };
                                    }
                                    <span class="badge @statusClass me-1">@order.orderStatus</span>

                                    @* Hiển thị Payment Status *@
                                    @{
                                        var payClass = order.paymentStatus switch
                                        {
                                            Order.PaymentStatus.Paid => "bg-success",
                                            Order.PaymentStatus.Unpaid => "bg-secondary",
                                            Order.PaymentStatus.Refunded => "bg-dark",
                                            _ => "bg-secondary"
                                        };
                                    }
                                    <span class="badge @payClass">@order.paymentStatus</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-8">
                                        <p class="mb-1 small"><strong>Người nhận:</strong> @order.FullName</p>
                                        <p class="mb-0 small text-muted text-truncate">
                                            <strong>Giao đến:</strong> @order.Street, @order.Ward, @order.District, @order.City
                                        </p>
                                    </div>
                                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                                        <span class="text-muted small d-block">Tổng cộng</span>
                                        <span class="h5 fw-bold text-danger">@order.TotalAmount.ToString("#,##0") VNĐ</span>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer bg-white border-top-0 d-flex justify-content-end pb-3">
                                <a asp-controller="Checkout" asp-action="Success" asp-route-id="@order.Id"
                                   class="btn btn-sm btn-outline-dark px-4 rounded-pill">
                                    Xem chi tiết
                                </a>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="text-center py-5">
                        <img src="https://cdn-icons-png.flaticon.com/512/4076/4076432.png" style="width: 100px; opacity: 0.5" />
                        <p class="mt-3 text-muted">Bạn chưa có đơn hàng nào.</p>
                        <a href="/" class="btn btn-primary px-4">Tiếp tục mua sắm</a>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        /* Tổng thể Sidebar */
        .sidebar-account .list-group-item {
            padding: 12px 18px;
            font-weight: 500;
            color: #444;
            transition: all 0.2s ease-in-out;
            background-color: transparent;
        }

            /* Khi di chuột qua (Hover) */
            .sidebar-account .list-group-item:hover {
                background-color: #f8f9fa;
                color: #000;
                transform: translateX(5px); /* Hiệu ứng nhích nhẹ sang phải */
            }

            /* KHI MỤC ĐƯỢC CHỌN (ACTIVE) - ĐỔI SANG MÀU ĐEN */
            .sidebar-account .list-group-item.active {
                background-color: #212529 !important; /* Màu đen Raven */
                color: #ffffff !important; /* Chữ trắng */
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                font-weight: 600;
            }

            /* Căn chỉnh icon cho đẹp */
            .sidebar-account .list-group-item i {
                font-size: 1.1rem;
                vertical-align: middle;
            }

        /* Đè lại các viền mặc định của Bootstrap */
        .list-group-item {
            border: none !important;
        }
    </style>
}